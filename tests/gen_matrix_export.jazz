require "../src/gen_noises.jazz"
require "../src/fips202.jazz"

export
fn gen_noises_entry_test() {
	//Compute rho_prime
	stack u8[64] rho_prime;
	stack u32[Li2_polydeg] buf;
	inline int i;

	for i = 0 to 64 {
		rho_prime[i] = 0;
	}

	buf = gen_noises_entry(rho_prime, 0, buf);
}

export
fn gen_noises_test(reg u64 s1ptr) {
	stack u8[64] rho_prime;

	stack u32[Li2_l * Li2_polydeg] s1;
	stack u32[Li2_k * Li2_polydeg] s2;

	reg u32 temp32;

	reg u32 c;
	reg u8 c8;

	inline int i j;

	for i = 0 to 64 {
		rho_prime[i] = 0;
	}
	s1, s2 = gen_noises(rho_prime);

	//for i = 0 to Li2_l * Li2_polydeg {
	for i = 0 to 30 {
		temp32 = s1[i];
		for j = 0 to 4 {
			c = temp32;
			c >>= (8 * j);
			c8 = (8u) c;
			(u8) [s1ptr + 4 * i + j] = c8;
		}
	}
}
